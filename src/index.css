@import 'mapbox-gl/dist/mapbox-gl.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* iOS Safe Area Support */
:root {
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
}

/* iOS Native App Styles - NO body padding, handle in components */
* {
  -webkit-tap-highlight-color: transparent;
}

html {
  overscroll-behavior: none;
  -webkit-overflow-scrolling: touch;
}

body {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overscroll-behavior: none;
  -webkit-overflow-scrolling: touch;
  /*
    IMPORTANT:
    We don't lock the entire document on all platforms.
    On some Android hardware/webviews (e.g. CM30), `position: fixed` on body
    can prevent nested scroll containers from scrolling.

    Scrolling is handled by app layout containers (e.g. DashboardLayout main).
    We only fully lock the document on native iOS where it helps prevent bounce.
  */
  width: 100%;
  min-height: 100%;
  overflow: hidden;
}

/* Lock document scrolling only for native iOS builds */
html.native-ios body {
  position: fixed;
  height: 100%;
}

/* Native iOS Button Feel */
button, a {
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  user-select: none;
  -webkit-user-select: none;
}

/* Input fields */
input, textarea {
  -webkit-user-select: auto;
  user-select: auto;
}

/* Prevent text selection on UI elements */
.no-select {
  user-select: none;
  -webkit-user-select: none;
}

/* iOS Native Header Styles - Solid background behind status bar */
.ios-header {
  padding-top: max(env(safe-area-inset-top), 0px);
  background-color: hsl(var(--card));
}

/* iOS Safe Area Support */
:root {
  --safe-area-inset-top: env(safe-area-inset-top);
  --safe-area-inset-right: env(safe-area-inset-right);
  --safe-area-inset-bottom: env(safe-area-inset-bottom);
  --safe-area-inset-left: env(safe-area-inset-left);
}

/* Prevent overscroll bounce on iOS - applied on the scroll container */
body {
  overscroll-behavior: none;
  -webkit-overflow-scrolling: touch;
}

/* iOS tap highlight */
* {
  -webkit-tap-highlight-color: transparent;
}

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Base Colors - Corporate Clean */
    --background: 220 20% 98%;
    --foreground: 220 25% 15%;
    --background-secondary: 220 15% 96%;

    /* Card Colors - Clean White */
    --card: 0 0% 100%;
    --card-foreground: 220 25% 15%;
    --card-solid: 0 0% 100%;
    
    /* Glass Effect Variables - Minimal */
    --glass-background: 0 0% 100% / 0.95;
    --glass-border: 220 15% 90%;
    --glass-shadow: 220 25% 50% / 0.06;

    --popover: 0 0% 100%;
    --popover-foreground: 220 25% 15%;

    /* Primary Color - Corporate Blue */
    --primary: 215 90% 45%;
    --primary-foreground: 0 0% 100%;
    --primary-light: 215 85% 60%;
    --primary-lighter: 215 80% 92%;
    --primary-dark: 215 95% 35%;
    --primary-darker: 215 95% 25%;
    --primary-glow: 215 90% 55%;

    /* Secondary Color - Neutral Gray */
    --secondary: 220 15% 95%;
    --secondary-foreground: 220 20% 25%;
    --secondary-light: 220 15% 97%;
    --secondary-dark: 220 15% 88%;

    /* Accent Color - Professional Teal */
    --accent: 195 80% 40%;
    --accent-foreground: 0 0% 100%;
    --accent-light: 195 75% 55%;
    --accent-dark: 195 85% 30%;

    /* Muted Colors */
    --muted: 220 15% 95%;
    --muted-foreground: 220 10% 45%;

    /* Status Colors - Professional */
    --success: 155 70% 40%;
    --success-foreground: 0 0% 100%;
    --success-light: 155 65% 55%;

    --warning: 40 95% 50%;
    --warning-foreground: 40 95% 15%;
    --warning-light: 40 95% 65%;

    --info: 205 90% 50%;
    --info-foreground: 0 0% 100%;
    --info-light: 205 85% 65%;

    --destructive: 0 75% 55%;
    --destructive-foreground: 0 0% 100%;
    --destructive-light: 0 70% 70%;

    /* Border & Input */
    --border: 220 15% 88%;
    --input: 220 15% 88%;
    --ring: 215 90% 45%;

    /* Border Radius - Professional */
    --radius: 0.625rem;
    --radius-lg: 0.875rem;
    --radius-xl: 1.25rem;

    /* Sidebar */
    --sidebar-background: 220 25% 15%;
    --sidebar-foreground: 220 15% 95%;
    --sidebar-primary: 215 90% 55%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 25% 22%;
    --sidebar-accent-foreground: 220 15% 95%;
    --sidebar-border: 220 25% 25%;
    --sidebar-ring: 215 90% 55%;
    
    /* Professional Gradients */
    --gradient-primary: linear-gradient(135deg, hsl(215 90% 45%), hsl(215 90% 35%));
    --gradient-primary-shift: linear-gradient(135deg, hsl(215 90% 35%), hsl(215 90% 45%));
    --gradient-secondary: linear-gradient(135deg, hsl(220 15% 95%), hsl(220 15% 92%));
    --gradient-accent: linear-gradient(135deg, hsl(195 80% 40%), hsl(205 85% 45%));
    --gradient-success: linear-gradient(135deg, hsl(155 70% 40%), hsl(155 70% 48%));
    --gradient-warning: linear-gradient(135deg, hsl(40 95% 50%), hsl(35 95% 55%));
    --gradient-hero: linear-gradient(135deg, hsl(215 90% 45%) 0%, hsl(205 85% 50%) 100%);
    --gradient-card: linear-gradient(180deg, hsl(0 0% 100%), hsl(220 15% 99%));
    --gradient-card-hover: linear-gradient(180deg, hsl(0 0% 100%), hsl(215 20% 98%));
    --gradient-mesh: radial-gradient(ellipse 80% 60% at 50% 0%, hsl(215 90% 95% / 0.5), transparent),
                     radial-gradient(ellipse 60% 40% at 100% 50%, hsl(195 80% 95% / 0.3), transparent);
    
    /* Clean Shadows */
    --shadow-sm: 0 1px 2px 0 hsl(220 25% 15% / 0.04);
    --shadow-md: 0 4px 8px -1px hsl(220 25% 15% / 0.06), 0 2px 4px -1px hsl(220 25% 15% / 0.04);
    --shadow-lg: 0 8px 16px -2px hsl(220 25% 15% / 0.08), 0 4px 8px -2px hsl(220 25% 15% / 0.05);
    --shadow-xl: 0 16px 32px -4px hsl(220 25% 15% / 0.1), 0 8px 16px -4px hsl(220 25% 15% / 0.06);
    --shadow-2xl: 0 24px 48px -8px hsl(220 25% 15% / 0.15);
    --shadow-inner: inset 0 1px 2px 0 hsl(220 25% 15% / 0.04);
    
    /* Subtle Glow Effects */
    --shadow-glow: 0 0 12px hsl(215 90% 45% / 0.15);
    --shadow-glow-sm: 0 0 6px hsl(215 90% 45% / 0.1);
    --shadow-glow-lg: 0 0 20px hsl(215 90% 45% / 0.2);
    --shadow-glow-accent: 0 0 12px hsl(195 80% 40% / 0.15);
    --shadow-glow-success: 0 0 10px hsl(155 70% 40% / 0.15);
    --shadow-glow-warning: 0 0 10px hsl(40 95% 50% / 0.15);
    
    /* Glass Morphism - Minimal */
    --backdrop-blur-sm: blur(4px);
    --backdrop-blur-md: blur(8px);
    --backdrop-blur-lg: blur(12px);
    --backdrop-blur-xl: blur(16px);
    
    /* Transitions */
    --transition-fast: 150ms ease;
    --transition-base: 200ms ease;
    --transition-slow: 300ms ease;
    --transition-bounce: 400ms cubic-bezier(0.34, 1.25, 0.64, 1);
    --transition-smooth: 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
    
    /* Typography Scale */
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;
    --font-size-2xl: 1.5rem;
    --font-size-3xl: 1.875rem;
    --font-size-4xl: 2.25rem;
    --font-size-5xl: 3rem;
    
    /* Font Weights */
    --font-weight-light: 300;
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    --font-weight-extrabold: 800;
  }

  .dark {
    /* Base Colors - Corporate Dark */
    --background: 220 25% 8%;
    --foreground: 220 15% 95%;
    --background-secondary: 220 25% 11%;

    /* Card Colors - Dark Elevated */
    --card: 220 25% 12%;
    --card-foreground: 220 15% 95%;
    --card-solid: 220 25% 12%;
    
    /* Glass Effect Variables - Dark Subtle */
    --glass-background: 220 25% 14% / 0.9;
    --glass-border: 220 20% 25%;
    --glass-shadow: 0 0% 0% / 0.25;

    --popover: 220 25% 12%;
    --popover-foreground: 220 15% 95%;

    /* Primary Color - Brighter in Dark */
    --primary: 215 85% 55%;
    --primary-foreground: 0 0% 100%;
    --primary-light: 215 80% 65%;
    --primary-lighter: 215 75% 80%;
    --primary-dark: 215 90% 45%;
    --primary-darker: 215 90% 35%;
    --primary-glow: 215 85% 60%;

    /* Secondary Color */
    --secondary: 220 25% 18%;
    --secondary-foreground: 220 15% 95%;
    --secondary-light: 220 25% 22%;
    --secondary-dark: 220 25% 14%;

    /* Accent Color - Professional Teal */
    --accent: 195 75% 50%;
    --accent-foreground: 0 0% 100%;
    --accent-light: 195 70% 60%;
    --accent-dark: 195 80% 40%;

    /* Muted Colors */
    --muted: 220 25% 18%;
    --muted-foreground: 220 15% 60%;

    /* Status Colors */
    --success: 155 65% 45%;
    --success-foreground: 0 0% 100%;
    --success-light: 155 60% 55%;

    --warning: 40 95% 55%;
    --warning-foreground: 40 95% 10%;
    --warning-light: 40 95% 65%;

    --info: 205 85% 55%;
    --info-foreground: 0 0% 100%;
    --info-light: 205 80% 65%;

    --destructive: 0 70% 60%;
    --destructive-foreground: 0 0% 100%;
    --destructive-light: 0 65% 70%;

    /* Border & Input */
    --border: 220 25% 22%;
    --input: 220 25% 22%;
    --ring: 215 85% 55%;

    /* Sidebar */
    --sidebar-background: 220 30% 6%;
    --sidebar-foreground: 220 15% 95%;
    --sidebar-primary: 215 85% 55%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 30% 15%;
    --sidebar-accent-foreground: 220 15% 95%;
    --sidebar-border: 220 30% 18%;
    --sidebar-ring: 215 85% 55%;
    
    /* Professional Gradients - Dark */
    --gradient-primary: linear-gradient(135deg, hsl(215 85% 55%), hsl(215 85% 45%));
    --gradient-primary-shift: linear-gradient(135deg, hsl(215 85% 45%), hsl(215 85% 55%));
    --gradient-secondary: linear-gradient(135deg, hsl(220 25% 18%), hsl(220 25% 22%));
    --gradient-accent: linear-gradient(135deg, hsl(195 75% 50%), hsl(205 80% 55%));
    --gradient-success: linear-gradient(135deg, hsl(155 65% 45%), hsl(155 65% 52%));
    --gradient-warning: linear-gradient(135deg, hsl(40 95% 55%), hsl(35 95% 60%));
    --gradient-hero: linear-gradient(135deg, hsl(215 85% 55%) 0%, hsl(205 80% 55%) 100%);
    --gradient-card: linear-gradient(180deg, hsl(220 25% 14%), hsl(220 25% 12%));
    --gradient-card-hover: linear-gradient(180deg, hsl(220 25% 18%), hsl(220 25% 15%));
    --gradient-mesh: radial-gradient(ellipse 80% 60% at 50% 0%, hsl(215 85% 20% / 0.3), transparent),
                     radial-gradient(ellipse 60% 40% at 100% 50%, hsl(195 75% 20% / 0.2), transparent);
    
    /* Clean Shadows - Dark */
    --shadow-sm: 0 1px 2px 0 hsl(0 0% 0% / 0.2);
    --shadow-md: 0 4px 8px -1px hsl(0 0% 0% / 0.25), 0 2px 4px -1px hsl(0 0% 0% / 0.2);
    --shadow-lg: 0 8px 16px -2px hsl(0 0% 0% / 0.3), 0 4px 8px -2px hsl(0 0% 0% / 0.25);
    --shadow-xl: 0 16px 32px -4px hsl(0 0% 0% / 0.35), 0 8px 16px -4px hsl(0 0% 0% / 0.3);
    --shadow-2xl: 0 24px 48px -8px hsl(0 0% 0% / 0.45);
    --shadow-inner: inset 0 1px 2px 0 hsl(0 0% 0% / 0.2);
    
    /* Subtle Glow Effects - Dark */
    --shadow-glow: 0 0 12px hsl(215 85% 55% / 0.2);
    --shadow-glow-sm: 0 0 6px hsl(215 85% 55% / 0.15);
    --shadow-glow-lg: 0 0 20px hsl(215 85% 55% / 0.25);
    --shadow-glow-accent: 0 0 12px hsl(195 75% 50% / 0.2);
    --shadow-glow-success: 0 0 10px hsl(155 65% 45% / 0.2);
    --shadow-glow-warning: 0 0 10px hsl(40 95% 55% / 0.2);
  }

  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground transition-colors duration-300;
    background-image: var(--gradient-mesh);
    background-attachment: fixed;
  }
  
  /* Enhanced Typography */
  h1, h2, h3, h4, h5, h6 {
    @apply font-semibold tracking-tight;
  }
  
  h1 {
    @apply text-4xl md:text-5xl;
  }
  
  h2 {
    @apply text-3xl md:text-4xl;
  }
  
  h3 {
    @apply text-2xl md:text-3xl;
  }
  
  /* Smooth scrolling */
  html {
    scroll-behavior: smooth;
  }
  
  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }
  
  ::-webkit-scrollbar-track {
    @apply bg-muted/30;
  }
  
  ::-webkit-scrollbar-thumb {
    @apply bg-primary/40 rounded-lg;
    transition: background-color 0.2s;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    @apply bg-primary/60;
  }
}

/* Animation utilities for NFC Scanner */
@layer utilities {
  .animation-delay-200 {
    animation-delay: 200ms;
  }
  
  .animation-delay-400 {
    animation-delay: 400ms;
  }
  
  /* Glassmorphism Utilities */
  .glass {
    background: hsl(var(--glass-background));
    backdrop-filter: var(--backdrop-blur-md);
    -webkit-backdrop-filter: var(--backdrop-blur-md);
    border: 1px solid hsl(var(--glass-border));
    box-shadow: 0 8px 32px 0 hsl(var(--glass-shadow));
  }
  
  .glass-light {
    background: hsl(var(--glass-background));
    backdrop-filter: var(--backdrop-blur-sm);
    -webkit-backdrop-filter: var(--backdrop-blur-sm);
    border: 1px solid hsl(var(--glass-border));
  }
  
  .glass-heavy {
    background: hsl(var(--glass-background));
    backdrop-filter: var(--backdrop-blur-lg);
    -webkit-backdrop-filter: var(--backdrop-blur-lg);
    border: 1px solid hsl(var(--glass-border));
    box-shadow: 0 8px 32px 0 hsl(var(--glass-shadow));
  }
  
  /* Glow Effects */
  .glow {
    box-shadow: var(--shadow-glow);
  }
  
  .glow-sm {
    box-shadow: var(--shadow-glow-sm);
  }
  
  .glow-lg {
    box-shadow: var(--shadow-glow-lg);
  }
  
  .glow-hover {
    transition: box-shadow var(--transition-base);
  }
  
  .glow-hover:hover {
    box-shadow: var(--shadow-glow);
  }
  
  /* Gradient Text */
  .gradient-text {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  .gradient-text-accent {
    background: var(--gradient-accent);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  /* Animated Gradients */
  .animate-gradient {
    background-size: 200% 200%;
    animation: gradient-shift 8s ease infinite;
  }
  
  @keyframes gradient-shift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  
  /* Hover Lift Effect */
  .hover-lift {
    transition: transform var(--transition-base), box-shadow var(--transition-base);
  }
  
  .hover-lift:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-xl);
  }
  
  /* Smooth Transitions */
  .transition-smooth {
    transition: all var(--transition-smooth);
  }
  
  .transition-bounce {
    transition: all var(--transition-bounce);
  }
  
  /* Bidirectional text utilities */
  .direction-ltr {
    direction: ltr !important;
  }
  
  .direction-rtl {
    direction: rtl !important;
  }
  
  .unicode-bidi-plaintext {
    unicode-bidi: plaintext;
  }
  
  .unicode-bidi-embed {
    unicode-bidi: embed;
  }
  
  .unicode-bidi-isolate {
    unicode-bidi: isolate;
  }
  
  /* Force LTR for numbers and Latin text */
  .number-display,
  .latin-text {
    direction: ltr !important;
    unicode-bidi: isolate;
  }
  
  /* RTL input styling for proper alignment */
  [dir="rtl"] input:not([type="number"]):not([type="date"]):not([type="time"]):not([type="datetime-local"]):not([type="email"]):not([type="url"]):not([type="tel"]):not([dir="ltr"]) {
    text-align: right !important;
    direction: ltr !important;
    unicode-bidi: plaintext !important;
  }
  
  /* Specific handling for phone and number inputs in RTL */
  [dir="rtl"] input[dir="ltr"]:not([type="email"]):not([type="date"]) {
    text-align: right !important;
    direction: ltr !important;
  }
  
  /* Email, date, and other special inputs should stay LTR aligned */
  [dir="rtl"] input[type="email"],
  [dir="rtl"] input[type="date"],
  [dir="rtl"] input[type="time"],
  [dir="rtl"] input[type="datetime-local"],
  [dir="rtl"] input[type="url"],
  [dir="rtl"] input[type="number"] {
    text-align: left !important;
    direction: ltr !important;
  }
  
  /* Placeholder alignment for RTL */
  [dir="rtl"] input::placeholder,
  [dir="rtl"] textarea::placeholder {
    text-align: right;
  }
  
  /* Textarea support for RTL */
  [dir="rtl"] textarea:not([dir="ltr"]) {
    text-align: right !important;
    direction: ltr !important;
    unicode-bidi: plaintext !important;
  }
}

/* Scanner overlay styles */
body.scanner-active {
  visibility: hidden;
}

body.scanner-active .scanner-ui {
  visibility: visible;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9999;
  background: rgba(0, 0, 0, 0.9);
  display: flex;
  align-items: center;
  justify-content: center;
}

.scanner-ui .scanner-box {
  width: 250px;
  height: 250px;
  border: 2px solid hsl(var(--primary));
  border-radius: 20px;
  position: relative;
}

.scanner-ui .scanner-line {
  position: absolute;
  width: 100%;
  height: 2px;
  background: hsl(var(--primary));
  animation: scan 2s linear infinite;
}

@keyframes scan {
  0% { top: 0; }
  50% { top: 100%; }
  100% { top: 0; }
}

/* Force LTR direction for numeric inputs (PIN, time, phone numbers, etc.) */
.dir-ltr,
[dir="ltr"],
input[type="number"],
input[type="tel"],
input[type="time"],
input[type="date"],
input[inputmode="numeric"] {
  direction: ltr !important;
  text-align: left !important;
}

/* RTL context with LTR content alignment */
[dir="rtl"] .dir-ltr,
[dir="rtl"] input[type="number"],
[dir="rtl"] input[type="tel"],
[dir="rtl"] input[type="time"],
[dir="rtl"] input[type="date"],
[dir="rtl"] input[inputmode="numeric"] {
  direction: ltr !important;
  text-align: left !important;
}
